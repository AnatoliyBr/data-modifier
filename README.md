# Data Modifier
Data Modifier - gRPC-—Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è/–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–π —Å–∏—Å—Ç–µ–º—ã.

–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
* toml, godotenv (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
* ozzo-validation (–≤–∞–ª–∏–¥–∞—Ü–∏—è)
* go.uber.org/zap (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
* google.golang.org/grpc (gRPC —Å–µ—Ä–≤–µ—Ä)
* grpc-ecosystem/go-grpc-middleware/v2/interceptors (gRPC –∏–Ω—Ç–µ—Ä—Å–µ–ø—Ç–æ—Ä—ã)
* testify, go.uber.org/mock/gomock (unit-—Ç–µ—Å—Ç—ã)

–ö–æ–¥ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω —Å–æ–≥–ª–∞—Å–Ω–æ Clean Architecture, –∏–Ω—ä–µ–∫—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∏–∑–∫—É—é —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å —Å–ª–æ–µ–≤ –∏ —É–ø—Ä–æ—â–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

–¢–∞–∫–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω Graceful Shutdown –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞. 

# Getting Started
–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞ `.env` —Ñ–∞–π–ª —Å –ª–æ–≥–∏–Ω–æ–º –∏ –ø–∞—Ä–æ–ª–µ–º –æ—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–µ–π —Å–∏—Å—Ç–µ–º—ã, –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ [.env.example](.env.example).

–ê —Ç–∞–∫–∂–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ `.toml` —Ñ–∞–π–ª, –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ [config.toml](configs/config.toml). –ü—É—Ç—å –∫ —ç—Ç–æ–º—É —Ñ–∞–π–ª—É –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Å —Ñ–ª–∞–≥–æ–º `-config-path` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø–∏—Å–∞—Ç—å –ª–æ–≥–∏ –∏ –æ—à–∏–±–∫–∏ –≤ —Ñ–∞–π–ª—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —ç—Ç–∏ —Ñ–∞–π–ª—ã –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø—É—Ç—å –∫ –Ω–∏–º –≤ –æ–ø—Ü–∏—è—Ö `output_path`/`error_output_path` (–ø–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. –Ω–∏–∂–µ).

<details>
    <summary> –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø—Ü–∏–π —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏: </summary>

* `tcp_ip`/`tcp_port` - IP-–∞–¥—Ä–µ—Å –∏ –ø–æ—Ä—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π gRPC —Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã . –ó–∞–º–µ—Ç—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å `:`.
* `max_clients` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π (—Ä–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏ –∑–∞–ø—Ä–æ—Å–æ–≤). 
* `num_pool_workers` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Ä—É—Ç–∏–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (—Ä–∞–∑–º–µ—Ä –ø—É–ª–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤).

–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ gRPC —Å–µ—Ä–≤–µ—Ä–∞:
```toml
tcp_ip="127.0.0.1"
tcp_port=":8081"
max_clients=10
num_pool_workers=5
```

* `web_api_ip`/`web_api_port` - IP-–∞–¥—Ä–µ—Å –∏ –ø–æ—Ä—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–µ–π —Å–∏—Å—Ç–µ–º—ã. –ó–∞–º–µ—Ç—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å `:`.
* `protocol_type` - HTTP –ø—Ä–æ—Ç–æ–∫–æ–ª ("http", "https").
* `employee_path` - –ø—É—Ç—å –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ —Å–æ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–π —Å–∏—Å—Ç–µ–º—ã. –ó–∞–º–µ—Ç—å—Ç–µ, —á—Ç–æ –ø—É—Ç—å —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è **–±–µ–∑** `/`.
* `absence_path` - –ø—É—Ç—å –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —Å—Ç–∞—Ç—É—Å–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–π —Å–∏—Å—Ç–µ–º—ã. –ó–∞–º–µ—Ç—å—Ç–µ, —á—Ç–æ –ø—É—Ç—å —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è **–±–µ–∑** `/`.

–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–π —Å–∏—Å—Ç–µ–º–æ–π:
```toml
web_api_ip="127.0.0.1"
web_api_port=":8082"
protocol_type="http"
employee_path="employees"
absence_path="absences"
```

* `log_format` - —Ñ–æ—Ä–º–∞—Ç –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –ª–æ–≥–æ–≤ ("json", "console").

–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ "json" –∏ "console":
```bash
{"L":"INFO","T":"2023-11-29T15:24:59.674+0300","C":"app/app.go:61","M":"Initializing UserWebAPI..."}

2023-11-29T13:22:41.524+0300    INFO    app/app.go:61   Initializing UserWebAPI...
```

* `log_level` - —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è ("debug", "info", "warn", "error"). –ó–∞–º–µ—Ç—å—Ç–µ, —á—Ç–æ –µ—Å–ª–∏ –ø–æ–¥–Ω—è—Ç—å `log_level` –¥–æ —É—Ä–æ–≤–Ω—è "error", —Ç–æ –ª–æ–≥–µ—Ä –ø—Ä–æ–ø—É—Å—Ç–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è "info", —Ç–∞–∫ –∫–∞–∫ –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∏–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è.
* `encoder_type` - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–µ–π —É –ø–æ–ª–µ–π –ª–æ–≥–æ–≤ ("dev", "prod"), –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `log_format`="json". –û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è [dev](https://pkg.go.dev/go.uber.org/zap#NewDevelopmentEncoderConfig) –∏ [prod](https://pkg.go.dev/go.uber.org/zap#NewProductionEncoderConfig).

–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞ —Ç–∏–ø–∞ "dev" –∏ "prod":
```bash
{"L":"INFO","T":"2023-11-29T16:36:59.832+0300","C":"app/app.go:62","M":"Initializing UserWebAPI..."}

{"level":"info","ts":1701264983.1611516,"caller":"app/app.go:62","msg":"Initializing UserWebAPI..."}
```

* `output_path`/`error_output_path` - **—Å–ø–∏—Å–∫–∏** –ø—É—Ç–µ–π –∫ —Ñ–∞–π–ª–∞–º –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –ª–æ–≥–æ–≤ –∏ –æ—à–∏–±–æ–∫.

–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ª–æ–≥–µ—Ä–∞:
```toml
log_format="console"
log_level="debug"
encoder_type="dev"
output_path=[ "stdout", "./tmp/logs/rpc_traffic.txt" ]
error_output_path=[ "stderr", "./tmp/logs/rpc_traffic_errors.txt" ]
```

</details>

# Usage
–î–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `make`.

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `make up`. –î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ —Å —Ç–µ—Å—Ç–æ–≤—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º - `make test-up`. 

–î–ª—è –∑–∞–ø—É—Å–∫–∞ unit-—Ç–µ—Å—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `make test`.

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –ª–∏–Ω—Ç–µ—Ä–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `make linter`.

## Examples
–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è **Postman** –∏ **—Ç–µ—Å—Ç–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä** –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–π —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ñ–ª–∞–≥–∞ `-test-server` (–∏–º–µ–Ω–Ω–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `make test-up`).

–ü–æ –∑–∞–¥–∞–Ω–∏—é —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å:

> ... –ø–æ –≤—Ö–æ–¥—è—â–µ–º—É gRPC –∑–∞–ø—Ä–æ—Å—É —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–æ email –Ω–∞–π—Ç–∏ —Ç–æ–≥–æ –∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –≤–Ω–µ—à–Ω–µ–º HTTP —Å–µ—Ä–≤–µ—Ä–µ, –∏ –æ–±–æ–≥–∞—Ç–∏—Ç—å –≤—Ö–æ–¥—è—â–µ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–§–ò–û) —Å—Ç–∞—Ç—É—Å–æ–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è, –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å (–≤ –∫–æ–Ω–µ—Ü –§–ò–û –¥–æ–ø–∏—Å–∞—Ç—å emoji —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å—Ç–∞—Ç—É—Å–æ–º).

–ë—ã–ª –æ–ø–∏—Å–∞–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–µ—Ä–≤–∏—Å–∞ `DataModifier` —Å Unary RPC –º–µ—Ç–æ–¥–æ–º `AddAbsenceStatus`.

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ emoji, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å—É –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è, –≤ –ø–æ–ª–µ display_name
–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è **emoji**, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å—É –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è, –≤ –ø–æ–ª–µ `display_name` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (–≤—Å–µ –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∏ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–æ–π) –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤—Ä–µ–º–µ–Ω–∏ (—Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "2006-01-02T15:04:05"):

```json
{
    "user_data": {
        "display_name": "–ò–≤–∞–Ω–æ–≤ –°–µ–º–µ–Ω –ü–µ—Ç—Ä–æ–≤–∏—á",
        "email": "petrovich@mail.ru",
        "mobile_phone": "+71234567890",
        "work_phone": "1234"
        
    },
    "time_period": {
        "date_from": "2022-07-01T00:00:00",
        "date_to": "2022-09-01T23:59:59"
    }
}
```

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:

```json
{
    "modified_user_data": {
        "display_name": "–ò–≤–∞–Ω–æ–≤ –°–µ–º–µ–Ω –ü–µ—Ç—Ä–æ–≤–∏—á üè†",
        "email": "petrovich@mail.ru",
        "mobile_phone": "+71234567890",
        "work_phone": "1234"
    }
}
```

**–ü—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏** –¥–ª—è –∫–∞–∂–¥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –º–µ—Ç–æ–¥–∞—Ö (–º–µ—Ç–æ–¥ [Validate](/internal/entity/user.go) –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è).

* `display_name` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ, –¥–æ–ª–∂–Ω–æ —Å–æ—Å—Ç–æ—è—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑ –±—É–∫–≤ unicode, –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–º–µ–Ω–∞/—Ñ–∞–º–∏–ª–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ò–≤–∞–Ω–æ–≤-–°–∏–¥–æ—Ä–æ–≤).
* `email` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω–æ–π —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç–æ–π.
* `mobile_phone` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ, –¥–æ–ª–∂–Ω–æ —Å–æ—Å—Ç–æ—è—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑ —Å–∏–º–≤–æ–ª–æ–≤ [0-9], –º–æ–∂–µ—Ç –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è –Ω–∞ "+", –¥–ª–∏–Ω–∞ –æ—Ç 10 –¥–æ 12 —Å–∏–º–≤–æ–ª–æ–≤.
* `work_phone` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ, –¥–æ–ª–∂–Ω–æ —Å–æ—Å—Ç–æ—è—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑ —Å–∏–º–≤–æ–ª–æ–≤ [0-9], –º–æ–∂–µ—Ç –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è –Ω–∞ "+", –¥–ª–∏–Ω–∞ –æ—Ç 1 –¥–æ 12 —Å–∏–º–≤–æ–ª–æ–≤.

# Decisions
–ß—Ç–æ–±—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥—å –∑–∞–ø—Ä–æ—Å–æ–≤, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±—É—Ñ–µ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ [–∑–¥–µ—Å—å](https://eli.thegreenplace.net/2019/on-concurrency-in-go-http-servers/). –õ–∏–±–æ –º–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —á–∏—Å–ª–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–ª—É—à–∞—Ç–µ–ª—è —Å –ø–æ–º–æ—â—å—é [netutil.LimitListener](https://pkg.go.dev/golang.org/x/net/netutil#LimitListener).

–ß—Ç–æ–±—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤–æ—Ä–∫–µ—Ä-–ø—É–ª, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ü–∏–∫–ª –≥–æ—Ä—É—Ç–∏–Ω, —Å—á–∏—Ç—ã–≤–∞—é—â–∏—Ö –∑–∞–¥–∞—á–∏ –∏–∑ –æ–±—â–µ–≥–æ –∫–∞–Ω–∞–ª–∞, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ [–∑–¥–µ—Å—å](https://gobyexample.com/worker-pools). –õ–∏–±–æ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ –¥–ª—è gRPC —Å–µ—Ä–≤–µ—Ä–∞ –∏–∑ –ø–∞–∫–µ—Ç–∞ [grpc](https://pkg.go.dev/google.golang.org/grpc) —Å –ø–æ–º–æ—â—å—é —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ [NumStreamWorkers](https://pkg.go.dev/google.golang.org/grpc#NumStreamWorkers).

<details>
<summary> –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è Unary RPC –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ) </summary>

–ó–∞—Ö–æ–¥–∏–º –≤ [grpc-go/server.go](https://github.com/grpc/grpc-go/blob/v1.59.0/server.go). –ù–∞—Ö–æ–¥–∏–º —Ñ—É–Ω–∫—Ü–∏—é `Serve`, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞ –∫–∞–∂–¥–æ–µ –Ω–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç –≥–æ—Ä—É—Ç–∏–Ω—É `handleRowConn`. `handleRowConn` –∑–∞–ø—É—Å–∫–∞–µ—Ç –≥–æ—Ä—É—Ç–∏–Ω—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –º–µ—Ç–æ–¥—ã `serveStreams` –∏ `removeConn`. –í `serveStreams` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `HandleStreams`, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤ –∫–∞–Ω–∞–ª `s.serverWorkerChannel` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è —Å –º–µ—Ç–æ–¥–æ–º `handleStream`.

–î–∞–ª–µ–µ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `serverWorker` —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ –∫–∞–Ω–∞–ª–∞ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è. –ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –∏ –º–µ—Ç–æ–¥ —Å—É—â–µ—Å—Ç–≤—É—é—Ç, `handleStream` –≤—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥ `processUnaryRPC` –∏–ª–∏ `processStreamingRPC`.

</details>

# Commands
<details>
<summary> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã</summary>

```bash
go get github.com/BurntSushi/toml

go get google.golang.org/grpc
go get google.golang.org/protobuf

go get golang.org/x/net

curl -sSfL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh | sh -s -- -b $(go env GOPATH)/bin v1.55.2

protoc --proto_path=api/proto --go_out=pkg --go-grpc_out=pkg api/proto/datamodifier.proto

go get go.uber.org/zap
go get github.com/grpc-ecosystem/go-grpc-middleware/v2/interceptors/recovery
go get github.com/grpc-ecosystem/go-grpc-middleware/v2/interceptors/logging

go get github.com/go-ozzo/ozzo-validation
go get github.com/go-ozzo/ozzo-validation/is

go get github.com/stretchr/testify

go install go.uber.org/mock/mockgen
go get go.uber.org/mock/mockgen

mockgen -source=./internal/webapi/interfaces.go -destination=./internal/webapi/webapi_mocks.go -package=webapi

go get github.com/gorilla/mux
```

</details>

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏
* [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è gRPC](https://grpc.io/) - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –∫–æ–º–ø–∞–Ω–∏–µ–π Google.
    * [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è Go Quick Start](https://grpc.io/docs/languages/go/quickstart/).
* [Protocol Buffers](https://protobuf.dev/) - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø–µ—Ä–µ–≤–æ–¥–∞ –≤ –ø–æ—Ç–æ–∫ –±–∞–π—Ç–æ–≤) –∏ —è–∑—ã–∫ –æ–ø–∏—Å–∞–Ω–∏—è gRPC, –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä.
    * [–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä](https://github.com/protocolbuffers/protobuf/releases/latest) Protocol Buffers, —á—Ç–æ–±—ã –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –∏–∑ proto-—Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–µ—Ä–≤–∏—Å–∞, –∫–æ–¥ –Ω–∞ –∫–∞–∫–æ–º-—Ç–æ —è–∑—ã–∫–µ.
    * [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è Protocol Buffer Basics: Go](https://protobuf.dev/getting-started/gotutorial/)
* [–ü–∏—à–µ–º gRPC —Å–µ—Ä–≤–∏—Å –Ω–∞ Go ‚Äî —Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏](https://habr.com/ru/articles/774796/)